# High-WR Trading System Configuration Template
# Copy this file to .env and update with your values

# ==============================================================================
# BYBIT CONFIGURATION (REQUIRED)
# ==============================================================================

# Bybit API Credentials
# Get testnet keys from: https://testnet.bybit.com/app/user/api-management
# Get live keys from: https://www.bybit.com/app/user/api-management
BYBIT_API_KEY=your_api_key_here
BYBIT_API_SECRET=your_api_secret_here
BYBIT_TESTNET=true  # Set to false for live trading

# ==============================================================================
# DATABASE CONFIGURATION
# ==============================================================================

# PostgreSQL Settings
POSTGRES_USER=trading
POSTGRES_PASSWORD=change_me_in_production_use_strong_password
POSTGRES_DB=high_wr_db
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# Database URL (auto-constructed, do not modify)
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# ==============================================================================
# REDIS CONFIGURATION
# ==============================================================================

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}/0

# ==============================================================================
# TRADINGVIEW WEBHOOK CONFIGURATION
# ==============================================================================

# Webhook Settings
WEBHOOK_API_KEY=your_secret_webhook_key_change_me  # Used for webhook authentication
WEBHOOK_RATE_LIMIT=60                               # Max requests per minute
WEBHOOK_ALLOWED_IPS=                                # Comma-separated, leave empty to allow all
WEBHOOK_TIMEOUT_SECONDS=30                          # Request timeout

# ==============================================================================
# TRADING CONFIGURATION
# ==============================================================================

# Optimization Mode
# true = HIGH_WIN_RATE mode (65-70% win rate, conservative)
# false = BALANCED mode (50-55% win rate, higher R/R)
OPTIMIZE_FOR_WIN_RATE=true
HIGH_WIN_RATE_MODE=true

# Risk Management
MAX_CONCURRENT_POSITIONS=10    # Maximum number of open positions
RISK_PER_TRADE_PCT=2.0         # Risk per trade as % of account
MAX_DAILY_LOSS_PCT=6.0         # Maximum daily loss as % of account
MAX_POSITION_SIZE_PCT=10.0     # Maximum position size as % of account

# Trading Pairs (comma-separated)
TRADING_SYMBOLS=BTC/USDT,ETH/USDT,SOL/USDT,DOGE/USDT

# Strategy Parameters
MIN_WIN_RATE=0.65              # Minimum win rate for strategy selection
MIN_TRADES_FOR_EVALUATION=20   # Minimum trades before evaluating strategy
STRATEGY_EVALUATION_PERIOD=7   # Days between strategy re-evaluation

# Optimization Settings (Optuna)
OPTUNA_N_TRIALS=100            # Number of optimization trials (100 = 3-5 min)
OPTUNA_N_JOBS=4                # Parallel jobs (4+ recommended)
OPTUNA_TIMEOUT=300             # Max optimization time in seconds (300 = 5 min)
MIN_BASELINE_TRADES=30         # Required baseline trades before optimization

# ==============================================================================
# APPLICATION CONFIGURATION
# ==============================================================================

# Environment
APP_ENV=production              # production, staging, development
DEBUG=false                     # Set to true for development only
SECRET_KEY=change_me_use_random_string_in_production

# CORS Settings
CORS_ORIGINS=http://localhost:3000,http://frontend:3000

# ==============================================================================
# SERVICE PORTS
# ==============================================================================

BACKEND_PORT=8000
FRONTEND_PORT=3000
POSTGRES_PORT=5432
REDIS_PORT=6379
PGADMIN_PORT=5050  # Optional, only if using PgAdmin
OPTUNA_DASHBOARD_PORT=8080  # Optuna real-time optimization monitoring

# ==============================================================================
# FRONTEND CONFIGURATION
# ==============================================================================

# API URLs for Frontend
VITE_API_URL=http://backend:8000
VITE_WS_URL=ws://backend:8000/ws
VITE_PUBLIC_API_URL=http://localhost:8000
VITE_PUBLIC_WS_URL=ws://localhost:8000/ws

# ==============================================================================
# PERFORMANCE SETTINGS
# ==============================================================================

# Worker Configuration
WORKERS=4                       # Number of API workers
MAX_CONNECTIONS=100            # Maximum database connections
CONNECTION_TIMEOUT=30          # Database connection timeout (seconds)

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60      # Requests per minute per IP

# ==============================================================================
# MONITORING & LOGGING
# ==============================================================================

# Logging Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO
LOG_TO_FILE=true
LOG_FILE_PATH=/app/logs/app.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=10

# Prometheus Metrics
ENABLE_METRICS=true
PROMETHEUS_PORT=9090
PROMETHEUS_RETENTION_DAYS=30
PROMETHEUS_RETENTION_SIZE_GB=10

# Grafana Dashboard
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=change_me_use_strong_password_in_production

# Sentry Error Tracking (optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production

# ==============================================================================
# OPTIONAL SERVICES
# ==============================================================================

# PgAdmin (Database Management UI)
ENABLE_PGADMIN=false
PGADMIN_EMAIL=admin@highwr.com
PGADMIN_PASSWORD=admin_password_change_me

# ==============================================================================
# NOTIFICATIONS & ALERTS (OPTIONAL)
# ==============================================================================

# Email Alerts (ERROR and CRITICAL only)
EMAIL_ALERTS_ENABLED=false
EMAIL_SMTP_HOST=smtp.gmail.com
EMAIL_SMTP_PORT=587
EMAIL_USERNAME=your_email@gmail.com
EMAIL_PASSWORD=your_app_specific_password
ALERT_EMAIL_TO=alerts@yourcompany.com

# Telegram Alerts (WARNING and above)
TELEGRAM_BOT_TOKEN=
TELEGRAM_CHAT_ID=

# Discord Alerts (all severities)
DISCORD_WEBHOOK_URL=

# Alert Types (automatic notifications):
# - optimization_complete: When Optuna optimization finishes
# - strategy_degradation: When strategy performance drops
# - phase_transition: When strategy moves Phase I → II → III
# - kill_switch: Circuit breaker triggers
# - system_health: Database/API issues

# ==============================================================================
# ADVANCED SETTINGS
# ==============================================================================

# Walk-Forward Analysis
ENABLE_WALK_FORWARD=true
WALK_FORWARD_WINDOW_DAYS=30
WALK_FORWARD_STEP_DAYS=7

# Grid Search Optimization
ENABLE_GRID_SEARCH=true
GRID_SEARCH_INTERVAL_HOURS=24
GRID_SEARCH_MAX_COMBINATIONS=1000

# Machine Learning Features
ENABLE_ML_PREDICTIONS=false
ML_MODEL_UPDATE_HOURS=6

# Beta Features
ENABLE_BETA_FEATURES=false
BETA_FEATURE_FLAGS=feature1,feature2

# ==============================================================================
# SECURITY
# ==============================================================================

# Session Configuration
SESSION_LIFETIME_MINUTES=1440  # 24 hours
SESSION_SECURE_COOKIES=true    # Use only with HTTPS
SESSION_SAME_SITE=strict

# API Security
API_KEY_REQUIRED=false         # Require API key for external access
API_KEY_HEADER=X-API-Key

# IP Whitelist (comma-separated, leave empty to allow all)
IP_WHITELIST=

# ==============================================================================
# DEPLOYMENT
# ==============================================================================

# Auto-restart on failure
RESTART_POLICY=unless-stopped

# Health Check Settings
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3

# Resource Limits
POSTGRES_MEMORY_LIMIT=4G
REDIS_MEMORY_LIMIT=512M
BACKEND_MEMORY_LIMIT=2G
FRONTEND_MEMORY_LIMIT=1G